; Testing function definitions.

def main
	set a, 12345
	jsr sqrt
	set pc, halt
end

:halt
	sub pc, 1

def sqrt
	equ SqrtShift, 14
	equ LoopCount, 16

	set push, i
	set i, 0
	set b, 0
	set c, 0

:sqrt_loop
	ife i, LoopCount
		set pc, sqrt_ret
	
	add i, 1
	shl c, 1
	shl b, 2
	shr a, SqrtShift
	add b, a
	shl a, 2
	add c, 1
	ifg c, b
		set pc, sqrt_loop_sub

	sub b, c
	add c, 1
	set pc, sqrt_loop

:sqrt_loop_sub
	sub c, 1
	set pc, sqrt_loop

:sqrt_ret
	set i, pop
	shr c, 1
	set a, c
end

